<!doctype html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="../vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>등록 | 신고센터 - 대한간호조무사협회</title>

    <!-- css -->
    <link rel="stylesheet" href="../resources/krds/css/plugin/swiper-bundle.min.css">
    <link rel="stylesheet" href="../resources/krds/css/component/output.css" />
    <link rel="stylesheet" href="../resources/krds/css/pattern/p_layout.css" />
    <link rel="stylesheet" href="../resources/css/style.css" />

    <!--js-->
    <script src="../resources/js/jquery-3.7.1.min.js"></script>
    <script src="../resources/krds/js/plugin/swiper-bundle.min.js"></script>
    <script src="../resources/krds/js/component/ui-script.js"></script>
    <script src="../resources/krds/js/pattern/pattern.js"></script>
    <script src="../resources/js/script.js"></script>
</head>

<body>
    <div id="wrap">
        <!-- 퍼블리싱단 header는 여기로 바로 삽입됨 -->


        <!-- 컨테이너 영역 -->
        <div id="container">
            <!-- 컨텐츠 영역 -->
            <div class="inner in-between">
                <!-- 사이드 메뉴 -->
                <nav class="krds-side-navigation">
                    <h1 class="lnb-tit">회원소통</h1>
                    <!-- lnb-list -->
                    <ul class="lnb-list">
                        <li class="lnb-item">
                            <a href="#" class="lnb-btn link">공지사항</a>
                        </li>
                        <li class="lnb-item">
                            <a href="#" class="lnb-btn link">회원게시판</a>
                        </li>
                        <li class="lnb-item active">
                            <a href="#" class="lnb-btn link active selected">신고센터</a>
                        </li>
                        <li class="lnb-item">
                            <a href="#" class="lnb-btn link">원격서비스</a>
                        </li>


                    </ul>

                    <!-- //lnb-list -->
                </nav>
                <!-- //사이드 메뉴 -->

                <div class="contents">
                    <!-- breadcrumb -->
                    <nav class="krds-breadcrumb-wrap align-items-center" aria-label="현재 경로" id="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="home"><a href="#" class="txt"><span class="sr-only">홈</span></a></li>
                            <li><a href="#;" class="txt">회원소통</a></li>
                            <li><a href="#;" class="txt">신고센터</a></li>
                        </ol>

                    </nav>
                    <!-- breadcrumb -->
                    <!-- 페이지 타이틀 영역 -->
                    <div class="page-title-wrap" data-type="responsive">
                        <h1 class="h-tit">신고센터</h1>

                        <ol class="breadcrumb-action">
                            <li>
                                <button class="icon-bg-round" onclick="window.print(); return false;">
                                    <i class="svg-icon ico-print"></i>
                                    <span class="sr-only">print</span>
                                </button>
                            </li>
                        </ol>
                    </div>
                    <!-- //페이지 타이틀 영역 -->


                    <!-- 게시판 상세페이지 start -->
                    <!-- 게시판 등록 start -->
                    <div class="board-detailed pageWrap">

                        <script>
                            // 폼 제출/유효성 검사
                            function handleSubmit() {
                                const formGroups = document.querySelectorAll('.form-group');
                                let isValid = true;
                                let firstInvalidEl = null;

                                formGroups.forEach(group => {
                                    const input = group.querySelector('input, textarea');
                                    const hint = group.querySelector('.form-hint-invalid');
                                    const wrap = group.querySelector('.form-conts');

                                    if (!input || input.hasAttribute('readonly')) return; // 읽기전용 필드는 제외
                                    const value = input.value.trim();

                                    if (value === '') {
                                        wrap?.classList.add('is-error');
                                        hint && (hint.style.display = 'flex');
                                        if (!firstInvalidEl) firstInvalidEl = input;
                                        isValid = false;
                                    } else {
                                        wrap?.classList.remove('is-error');
                                        hint && (hint.style.display = 'none');
                                    }
                                });

                                if (!isValid && firstInvalidEl) {
                                    firstInvalidEl.focus();
                                } else {
                                    document.querySelector('form').submit();
                                }
                            }

                        </script>



                        <form action="">
                            <div class="page-content">
                                <div class="guide-txt mt20">
                                    <p class="fw-medium mb20">신고 내용에 대한 답변은 기재하신 이메일 주소로 전송됩니다.</p>
                                    <ul class="krds-info-list decimal" role="list">
                                        <li role="listitem">
                                            <span class="blue">평일16시 이후 접수 건은 익일 오전 9시부터 순차적으로 답변이 가능합니다. (주말/공휴일 제외)</span>
                                        </li>
                                        <li role="listitem">작성하신 글에 대한 답변은 ’마이페이지 > 나의게시물 > 신고센터’에서 확인이 가능합니다.</li>
                                    </ul>
                                </div>


                                <div class="form-list form-list-margin">
                                    <fieldset class="fieldset">


                                        <!-- 폼그룹 -->
                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">작성자</label>
                                            </div>
                                            <div class="form-conts btn-ico-wrap" data-delete="true">
                                                <div class="form-input">
                                                    <input type="text" id="writer" class="krds-input medium"
                                                        placeholder="abc*****" readonly>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- //폼그룹 -->

                                        <!-- 폼그룹 -->
                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">휴대전화</label>
                                            </div>
                                            <div class="form-conts">

                                                <div class="input-form">
                                                    <ul class="input-group range">
                                                        <li>
                                                            <select name="" id="" class="krds-form-select medium">
                                                                <option value="">선택</option>
                                                                <option value="010" selected>010</option>
                                                                <option value="011">011</option>
                                                            </select>

                                                        </li>
                                                        <li class="mark">-</li>
                                                        <li>

                                                            <input type="text" id="phone-mid" class="krds-input medium"
                                                                value="1234" maxlength="4">

                                                        </li>
                                                        <li class="mark">-</li>
                                                        <li>

                                                            <input type="text" id="phone-last" class="krds-input medium"
                                                                maxlength="4" value="1234">

                                                        </li>

                                                    </ul>
                                                </div>

                                            </div>
                                        </div>
                                        <!-- //폼그룹 -->

                                        <!-- 폼그룹 -->
                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">이메일<i class="req">*</i></label>
                                            </div>
                                            <div class="form-conts">
                                                <div class="input-form">

                                                    <ul class="input-group range">
                                                        <li>
                                                            <input type="text" id="email-id" class="krds-input medium"
                                                                placeholder="" value="">

                                                        </li>
                                                        <li class="mark">@</li>
                                                        <li>
                                                            <input type="text" id="email-domain"
                                                                class="krds-input medium" placeholder=""
                                                                data-role="email-domain" value="" readonly>
                                                        </li>
                                                        <li>

                                                            <select id="email3" name="email3"
                                                                class="krds-form-select medium"
                                                                onchange="handleEmailDomainChange(this)">
                                                                <option value="" selected="">직접입력</option>
                                                                <option value="naver.com">naver.com</option>
                                                                <option value="daum.net">daum.net</option>
                                                                <option value="hotmail.com">hotmail.com</option>
                                                                <option value="nate.com">nate.com</option>
                                                                <option value="paran.com">paran.com</option>
                                                                <option value="dreamwiz.com">dreamwiz.com</option>
                                                                <option value="gmail.com">gmail.com</option>
                                                            </select>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <p class="form-hint-invalid" style="display: none;">이메일을 입력해주세요</p>

                                            </div>
                                        </div>
                                        <!-- //폼그룹 -->





                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">제목<i class="req">*</i></label>
                                            </div>
                                            <div class="form-conts">
                                                <input type="text" id="title" class="krds-input medium" placeholder=""
                                                    value="">
                                                <p class="form-hint-invalid" style="display: none;">제목을 입력해주세요</p>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">내용<i class="req">*</i></label>
                                            </div>
                                            <div class="form-conts">
                                                <textarea name="" id="content" class="krds-input"
                                                    oninput="updateTextareaCount(this)" maxlength="3000"></textarea>
                                                <p class="form-hint-invalid" style="display: none;">내용을 입력해주세요</p>
                                                <input type="file" id="q_file_input" multiple style="display:none;"
                                                    onchange="handleFileSelect(this)" />
                                                <p class="textarea-count">
                                                    <span class="count-now">0</span><span
                                                        class="count-total">/3000</span>
                                                </p>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <div class="form-tit">
                                                <label for="">파일첨부</label>
                                            </div>
                                            <div class="form-conts">
                                                <button type="button" class="krds-btn black medium" id=""
                                                    onclick="openFileDialog(this)">파일선택</button>
                                                <p class="form-hint">파일 최대 10MB / 전체 파일 최대 50MB</p>
                                            </div>
                                        </div>


                                    </fieldset>

                                </div>



                                <div class="detailed-file-wrap">
                                    <div class="tit">첨부파일목록</div>
                                    <ul class="list">
                                    </ul>
                                </div>

                            </div>


                            <div class="btnList-sort center">
                                <button type="button" class="krds-btn" onclick="handleSubmit()">저장</button>
                                <button type="button" class="krds-btn blue">목록</button>
                            </div>
                        </form>
                    </div>
                    <!-- 게시판 등록 end-->

                    <script>
                        $(document).ready(function () {
                            // 전역 파일 배열
                            const uploadedFiles = [];


                            // 이메일 도메인 자동 입력
                            window.handleEmailDomainChange = function (selectEl) {
                                const $select = $(selectEl);
                                const $domainInput = $select.closest("ul").find('[data-role="email-domain"]');
                                const selectedValue = $select.val();

                                if (selectedValue === "") {
                                    $domainInput.val("").prop("readonly", false);
                                } else if (selectedValue === "custom") {
                                    $domainInput.val("").prop("readonly", false).focus();
                                } else {
                                    $domainInput.val(selectedValue).prop("readonly", true);
                                }
                            };

                            // textarea 글자 수 카운트 (최대 3000자)
                            window.updateTextareaCount = function (textareaEl) {
                                const $textarea = $(textareaEl);
                                const $countNowEl = $textarea.closest('.form-conts').find('.count-now');
                                if (!$countNowEl.length) return;

                                let value = $textarea.val();
                                if (value.length > 3000) {
                                    value = value.substring(0, 3000);
                                    $textarea.val(value);
                                }
                                $countNowEl.text(value.length);
                            };

                            // 파일 확장자 구분용 클래스 반환
                            window.getFileTypeClass = function (fileName) {
                                const ext = fileName.split('.').pop().toLowerCase();
                                const imageExts = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'];
                                const docExts = ['pdf', 'hwp', 'doc', 'docx', 'ppt', 'pptx', 'xls', 'xlsx', 'txt', 'zip'];

                                if (imageExts.includes(ext)) return 'file-img';
                                if (docExts.includes(ext)) return 'file-doc';
                                return 'file-etc';
                            };

                            // 파일 선택 창 열기
                            window.openFileDialog = function () {
                                $('#q_file_input').click();
                            };

                            // 파일 선택 후 첨부 목록 출력
                            window.handleFileSelect = function (inputEl) {
                                const newFiles = Array.from(inputEl.files);
                                const $fileList = $('.detailed-file-wrap .list');
                                if (!$fileList.length) return;

                                newFiles.forEach(file => {
                                    const uniqueId = Date.now() + Math.random().toString(36).substr(2, 9);
                                    uploadedFiles.push({ id: uniqueId, file });

                                    const sizeKB = Math.round(file.size / 1024);
                                    const fileTypeClass = getFileTypeClass(file.name);

                                    const $li = $(`
                                    <li data-id="${uniqueId}">
                                        <a href="#" class="${fileTypeClass}" title="파일첨부">
                                            <p>${file.name}</p>
                                            <span>(${sizeKB}KB)</span>
                                        </a>
                                        <button type="button" class="krds-btn tertiary fileBtn" data-id="${uniqueId}">
                                            삭제<i class="svg-icon ico-delete-fill"></i>
                                        </button>
                                    </li>
                                `);

                                    $fileList.append($li);
                                });

                                $(inputEl).val(''); // 동일 파일 다시 첨부 가능하도록 초기화
                            };

                            // 첨부 파일 삭제 (동적 요소 대응)
                            $(document).on("click", ".fileBtn", function () {
                                const fileId = $(this).data("id");
                                const index = uploadedFiles.findIndex(f => f.id === fileId);
                                if (index > -1) uploadedFiles.splice(index, 1);
                                $(this).closest("li").remove();
                            });
                        });
                    </script>
                    <!-- 게시판 상세페이지 end-->

                </div>

            </div>
            <!-- //컨텐츠 영역 -->
        </div>
        <!-- //컨테이너 영역 -->

        <!-- 퍼블리싱단 footer는 여기로 바로 삽입됨 -->

    </div>

</body>

</html>



<script>

    // 퍼블리싱 단에만 사용하는 공통 스크립트
    // 개발에서는 절대 사용하지 말것!

    document.addEventListener("DOMContentLoaded", function () {
        loadHTML("../pages/common/header_pubSample.html", "beforebegin");
        loadHTML("../pages/common/footer_pubSample.html", "afterend");
    });

    function loadHTML(url, position) {
        fetch(url)
            .then((response) => {
                if (response.ok) {
                    return response.text();
                } else {
                    console.error(`Failed to load ${url}: ${response.status}`);
                    return "";
                }
            })
            .then((html) => {
                if (position === "beforebegin") {
                    document.body.insertAdjacentHTML("afterbegin", html);
                    initializeCommonScripts();
                } else if (position === "afterend") {
                    document.body.insertAdjacentHTML("beforeend", html);
                }
            })
            .catch((error) => console.error("Error loading HTML:", error));
    }

    function initializeCommonScripts() {
        // 메뉴 스크립트 초기화
        if (typeof krds_mainMenuPC !== "undefined") krds_mainMenuPC.init();
        if (typeof krds_mainMenuMobile !== "undefined") krds_mainMenuMobile.init();
        if (typeof krds_modal !== "undefined") krds_modal.init();
        if (typeof scrollManager !== "undefined") {
            window.addEventListener("scroll", () => {
                scrollManager.updateScrollValues();
                scrollManager.handleScrollDirection();
            });
        }
    }
</script>